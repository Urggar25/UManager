<!DOCTYPE html>
<html lang="fr">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>UManager ¬∑ Tableau de bord</title>
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css2?family=Noto+Sans:wght@400;500;600;700&display=swap"
    />
    <link rel="stylesheet" href="assets/styles.css" />
  </head>
  <body>
    <div class="app">
      <header class="topbar" aria-label="Navigation principale">
        <div class="topbar-brand">
          <span class="brand-logo" aria-hidden="true">üìä</span>
          <span class="brand-name">UManager</span>
        </div>
        <nav class="topbar-nav" aria-label="Modules">
          <button class="topbar-button" type="button" data-top-target="calendar">
            Calendrier
          </button>
          <button class="topbar-button active" type="button" data-top-target="tasks">
            T√¢ches
          </button>
          <button class="topbar-button" type="button" data-top-target="directory">
            R√©pertoire
          </button>
          <button class="topbar-button" type="button" data-top-target="communication">
            Communication
          </button>
          <button class="topbar-button" type="button" data-top-target="team" id="topbar-team">
            √âquipe
          </button>
        </nav>
        <div class="topbar-user" aria-live="polite">
          <span class="topbar-user-label">Connect√©&nbsp;:</span>
          <strong id="current-username">‚Äî</strong>
          <button id="logout-button" class="logout-button" type="button">Se d√©connecter</button>
        </div>
      </header>
      <div class="app-shell">
        <main class="content" aria-live="polite">
          <section id="tasks-summary" class="page active" aria-labelledby="tasks-summary-title">
            <header class="page-header">
              <div>
                <h1 id="tasks-summary-title">R√©capitulatif des t√¢ches</h1>
                <p class="page-subtitle">
                  Visualisez la charge de travail en cours et l'historique des actions archiv√©es.
                </p>
              </div>
            </header>
            <div class="task-summary-grid" role="list">
              <article class="task-summary-card" role="listitem">
                <h2>T√¢ches en cours</h2>
                <p id="task-summary-active" class="task-summary-value">0</p>
                <p class="task-summary-caption">T√¢ches actives assign√©es √† l'√©quipe.</p>
              </article>
              <article class="task-summary-card" role="listitem">
                <h2>T√¢ches archiv√©es</h2>
                <p id="task-summary-archived" class="task-summary-value">0</p>
                <p class="task-summary-caption">Historique des t√¢ches termin√©es ou cl√¥tur√©es.</p>
              </article>
            </div>
            <div class="task-summary-actions">
              <button class="primary-button" type="button" data-navigate="tasks-list">
                Acc√©der √† la recherche de t√¢ches
              </button>
            </div>
          </section>

          <section id="tasks-organization" class="page" aria-labelledby="tasks-organization-title">
            <header class="page-header">
              <div>
                <h1 id="tasks-organization-title">Organisation des t√¢ches</h1>
                <p class="page-subtitle">
                  Cr√©ez et classez vos cat√©gories afin de structurer la r√©partition du travail.
                </p>
              </div>
            </header>

            <section class="task-category-manager" aria-labelledby="task-category-manager-title">
              <header class="task-category-manager-header">
                <div>
                  <h2 id="task-category-manager-title">Organiser par cat√©gories</h2>
                  <p class="task-category-manager-subtitle">
                    Cr√©ez des cat√©gories personnalis√©es pour classer vos t√¢ches et naviguez facilement entre elles.
                  </p>
                </div>
              </header>
              <form id="task-category-form" class="task-category-form" autocomplete="off">
                <div class="task-category-form-grid">
                  <div class="form-row">
                    <label for="task-category-name">Nom de la cat√©gorie *</label>
                    <input
                      id="task-category-name"
                      name="task-category-name"
                      type="text"
                      maxlength="40"
                      required
                      placeholder="Ex. Urgent, Partenaires, Communication"
                    />
                  </div>
                  <div class="form-row">
                    <label for="task-category-color">Couleur</label>
                    <input
                      id="task-category-color"
                      name="task-category-color"
                      type="color"
                      value="#4f46e5"
                    />
                  </div>
                  <div class="task-category-form-actions">
                    <button type="submit" class="task-category-submit">Cr√©er la cat√©gorie</button>
                    <button
                      type="reset"
                      class="task-category-reset"
                      aria-label="R√©initialiser le formulaire des cat√©gories"
                    >
                      ‚Ü∫
                    </button>
                  </div>
                </div>
              </form>
              <ul id="task-category-list" class="task-category-list" aria-live="polite"></ul>
              <p id="task-category-empty" class="task-category-empty">
                Aucune cat√©gorie de t√¢che pour le moment. Utilisez le formulaire ci-dessus pour en ajouter.
              </p>
            </section>
          </section>

          <section id="tasks-create" class="page" aria-labelledby="tasks-create-title">
            <header class="page-header">
              <div>
                <h1 id="tasks-create-title">Cr√©er une t√¢che</h1>
                <p id="task-panel-description" class="page-subtitle">
                  Centralisez vos actions et attribuez-les aux membres de l'√©quipe.
                </p>
              </div>
            </header>

            <form id="task-form" class="task-form" autocomplete="off">
              <div class="task-form-grid">
                <div class="form-row">
                  <label for="task-title">Titre de la t√¢che *</label>
                  <input
                    id="task-title"
                    name="task-title"
                    type="text"
                    required
                    maxlength="140"
                    placeholder="Ex. Relancer les partenaires, pr√©parer un dossier"
                  />
                </div>
                <div class="form-row">
                  <label for="task-due-date">Date limite</label>
                  <input id="task-due-date" name="task-due-date" type="date" />
                </div>
                <div class="form-row">
                  <label for="task-category">Cat√©gorie</label>
                  <select id="task-category" name="task-category">
                    <option value="">Sans cat√©gorie</option>
                  </select>
                </div>
                <div class="form-row">
                  <label for="task-color">Couleur</label>
                  <input id="task-color" name="task-color" type="color" value="#2563eb" />
                </div>
              </div>
              <div class="form-row">
                <label for="task-members">Attribuer √†</label>
                <select
                  id="task-members"
                  name="task-members"
                  class="task-members-select"
                  multiple
                  aria-describedby="task-members-hint"
                ></select>
                <p id="task-members-hint" class="form-hint">
                  Maintenez la touche Ctrl (ou Cmd sur Mac) pour s√©lectionner plusieurs membres.
                </p>
              </div>
              <div class="form-row">
                <label for="task-description">Description</label>
                <textarea
                  id="task-description"
                  name="task-description"
                  rows="3"
                  maxlength="500"
                  placeholder="Pr√©cisez les objectifs ou les √©tapes √† suivre (optionnel)."
                ></textarea>
              </div>
              <div class="form-row task-attachment-field">
                <label for="task-attachment">Document associ√©</label>
                <input
                  id="task-attachment"
                  name="task-attachment"
                  type="file"
                  accept=".pdf,.doc,.docx,.xls,.xlsx,.ppt,.pptx,.png,.jpg,.jpeg,.txt,.zip"
                />
                <p class="form-hint">
                  Formats courants accept√©s (PDF, Word, tableurs, images). Taille maximale 2&nbsp;Mo.
                </p>
                <div id="task-attachment-preview" class="task-attachment-preview" hidden>
                  <div class="task-attachment-preview-icon" aria-hidden="true">üìé</div>
                  <div class="task-attachment-preview-info">
                    <span id="task-attachment-preview-name" class="task-attachment-preview-name"></span>
                    <span id="task-attachment-preview-meta" class="task-attachment-preview-meta"></span>
                  </div>
                  <div class="task-attachment-preview-actions">
                    <a
                      id="task-attachment-preview-open"
                      class="task-attachment-preview-action"
                      href="#"
                      target="_blank"
                      rel="noopener"
                    >
                      Ouvrir
                    </a>
                    <button id="task-attachment-remove" type="button" class="task-attachment-preview-remove">
                      Retirer
                    </button>
                  </div>
                </div>
                <p id="task-attachment-removed-message" class="task-attachment-removed-message" hidden>
                  Le document existant sera supprim√© lors de l‚Äôenregistrement.
                </p>
              </div>
              <div class="task-form-actions">
                <button type="submit" class="primary-button">Ajouter la t√¢che</button>
                <button type="reset" class="secondary-button">R√©initialiser</button>
              </div>
            </form>
          </section>

          <section id="tasks-list" class="page" aria-labelledby="tasks-list-title">
            <header class="page-header">
              <div>
                <h1 id="tasks-list-title">Tableau Kanban des t√¢ches</h1>
                <p class="page-subtitle">
                  Visualisez vos actions par cat√©gorie dans un tableau Kanban et suivez leur avancement en un coup d‚Äô≈ìil.
                </p>
              </div>
              <span id="task-count-badge" class="task-count-badge" aria-live="polite">0 t√¢che</span>
            </header>

            <div class="task-list-actions">
              <button class="secondary-button" type="button" data-navigate="tasks-create">
                Cr√©er une nouvelle t√¢che
              </button>
            </div>

            <div class="task-list-controls">
              <div class="task-status-filter" role="group" aria-label="Filtrer les t√¢ches par statut">
                <button
                  type="button"
                  class="task-status-button active"
                  data-task-status="active"
                  aria-pressed="true"
                >
                  En cours
                  <span class="task-status-count" data-task-status-count="active">0</span>
                </button>
                <button
                  type="button"
                  class="task-status-button"
                  data-task-status="archived"
                  aria-pressed="false"
                >
                  Archiv√©es
                  <span class="task-status-count" data-task-status-count="archived">0</span>
                </button>
              </div>
              <div class="task-category-nav-wrapper">
                <div
                  id="task-category-nav"
                  class="task-category-nav"
                  role="tablist"
                  aria-label="Filtrer les t√¢ches par cat√©gorie"
                >
                  <span id="task-category-indicator" class="task-category-indicator" aria-hidden="true"></span>
                </div>
              </div>
            </div>
            <div class="task-list-wrapper">
              <div id="task-list" class="task-list" aria-live="polite"></div>
              <p id="task-empty-state" class="task-empty-state">
                Aucune carte n‚Äôest disponible pour le moment. Ajoutez votre premi√®re t√¢che depuis l‚Äôonglet ¬´&nbsp;Cr√©er une t√¢che&nbsp;¬ª.
              </p>
            </div>
          </section>

          <section id="team-chat" class="page" aria-labelledby="team-chat-title">
            <header class="page-header">
              <div>
                <h1 id="team-chat-title">Tchat interne</h1>
                <p class="page-subtitle">
                  √âchangez en direct avec les membres de l'√©quipe pour coordonner vos actions.
                </p>
              </div>
            </header>

            <div class="team-chat-panel">
              <div class="team-chat-messages-wrapper">
                <ul
                  id="team-chat-messages"
                  class="team-chat-messages"
                  aria-live="polite"
                  role="list"
                ></ul>
                <p id="team-chat-empty" class="team-chat-empty">
                  Aucun message pour le moment. D√©marrez la conversation avec votre √©quipe.
                </p>
              </div>
              <form id="team-chat-form" class="team-chat-form" autocomplete="off">
                <div class="form-row">
                  <label class="sr-only" for="team-chat-input">Votre message</label>
                  <textarea
                    id="team-chat-input"
                    name="team-chat-input"
                    rows="3"
                    maxlength="500"
                    placeholder="√âcrivez un message √† votre √©quipe..."
                    required
                  ></textarea>
                </div>
                <div class="team-chat-actions">
                  <button type="submit" class="primary-button">Envoyer</button>
                </div>
              </form>
            </div>
          </section>

          <section id="categories" class="page" aria-labelledby="categories-title">
            <header class="page-header">
              <div>
                <h1 id="categories-title">Gestion des cat√©gories</h1>
                <p class="page-subtitle">
                  Cr√©ez, modifiez et supprimez les cat√©gories qui structurent vos donn√©es.
                </p>
              </div>
              <div class="insight-card">
                <span class="insight-label">Cat√©gories actives</span>
                <span class="insight-value" id="categories-active-count">0</span>
              </div>
            </header>
            <form id="category-form" class="category-form" autocomplete="off">
              <div class="form-row">
                <label for="category-name">Nom de la cat√©gorie *</label>
                <input
                  id="category-name"
                  name="category-name"
                  type="text"
                  required
                  maxlength="80"
                  placeholder="Ex. Donateurs, B√©n√©voles, Prospects"
                />
              </div>
              <div class="form-row">
                <label for="category-description">Description</label>
                <textarea
                  id="category-description"
                  name="category-description"
                  maxlength="240"
                  placeholder="D√©crivez la cat√©gorie pour vos √©quipes (optionnel)."
                  rows="3"
                ></textarea>
              </div>
              <div class="form-row">
                <label for="category-type">Type de valeur *</label>
                <select id="category-type" name="category-type" required>
                  <option value="text" selected>Texte</option>
                  <option value="number">Nombre</option>
                  <option value="date">Date</option>
                  <option value="list">Liste</option>
                </select>
              </div>
              <div class="form-row" id="category-options-row" hidden>
                <label for="category-options">Liste de valeurs</label>
                <textarea
                  id="category-options"
                  name="category-options"
                  rows="3"
                  maxlength="500"
                  placeholder="Saisissez une valeur par ligne"
                ></textarea>
                <p class="form-hint">Ces valeurs seront propos√©es lors de la saisie du contact.</p>
              </div>
              <button type="submit" class="primary-button">Ajouter la cat√©gorie</button>
            </form>
            <div class="category-list-wrapper">
              <ul id="category-list" class="category-list" aria-live="polite"></ul>
              <p id="category-empty-state" class="empty-state">
                Ajoutez vos premi√®res cat√©gories pour organiser vos donn√©es professionnelles.
              </p>
            </div>
          </section>

          <section id="keywords" class="page" aria-labelledby="keywords-title">
            <header class="page-header">
              <div>
                <h1 id="keywords-title">Gestion des mots cl√©s</h1>
                <p class="page-subtitle">
                  Cr√©ez des mots cl√©s libres pour affiner vos recherches avanc√©es.
                </p>
              </div>
              <div class="insight-card">
                <span class="insight-label">Mots cl√©s actifs</span>
                <span class="insight-value" id="keywords-active-count">0</span>
              </div>
            </header>
            <form id="keyword-form" class="keyword-form" autocomplete="off">
              <div class="form-row">
                <label for="keyword-name">Nom du mot cl√© *</label>
                <input
                  id="keyword-name"
                  name="keyword-name"
                  type="text"
                  required
                  maxlength="80"
                  placeholder="Ex. M√©c√®ne, Relance, Association locale"
                />
              </div>
              <div class="form-row">
                <label for="keyword-description">Description</label>
                <textarea
                  id="keyword-description"
                  name="keyword-description"
                  maxlength="240"
                  placeholder="Pr√©cisez l'usage du mot cl√© pour vos √©quipes (optionnel)."
                  rows="3"
                ></textarea>
              </div>
              <button type="submit" class="primary-button">Ajouter le mot cl√©</button>
            </form>
            <div class="keyword-list-wrapper">
              <ul id="keyword-list" class="keyword-list" aria-live="polite"></ul>
              <p id="keyword-empty-state" class="empty-state">
                Ajoutez vos premiers mots cl√©s pour affiner vos filtres de recherche.
              </p>
            </div>
          </section>

          <section id="contacts-add" class="page" aria-labelledby="contacts-add-title">
            <header class="page-header">
              <div>
                <h1 id="contacts-add-title">Ajouter un contact</h1>
                <p class="page-subtitle">
                  Cr√©ez un contact manuellement et associez-le aux cat√©gories et mots cl√©s pertinents.
                </p>
              </div>
              <div class="insight-card">
                <span class="insight-label">Contacts enregistr√©s</span>
                <span class="insight-value" id="contacts-count">0</span>
              </div>
            </header>
            <form id="contact-form" class="contact-form" autocomplete="off">
              <div class="form-row">
                <label for="contact-type">Type de contact</label>
                <select id="contact-type" name="contact-type">
                  <option value="person" selected>Personne</option>
                  <option value="company">Entreprise</option>
                  <option value="association">Association</option>
                  <option value="institution">Institution</option>
                </select>
              </div>
              <fieldset id="contact-categories-fieldset" class="form-fieldset">
                <legend>Donn√©es personnalis√©es</legend>
                <p class="form-hint">
                  Renseignez les valeurs associ√©es √† chaque cat√©gorie cr√©√©e dans l‚Äôonglet ¬´&nbsp;Cat√©gories&nbsp;¬ª.
                </p>
                <div id="contact-category-fields" class="form-grid" aria-live="polite"></div>
                <p id="contact-categories-empty" class="empty-state" hidden>
                  Aucune cat√©gorie disponible pour le moment. Ajoutez vos cat√©gories dans l‚Äôonglet ¬´&nbsp;Cat√©gories&nbsp;¬ª.
                </p>
              </fieldset>
              <fieldset id="contact-keywords-fieldset" class="form-fieldset">
                <legend>Mots cl√©s associ√©s</legend>
                <p class="form-hint">
                  S√©lectionnez les mots cl√©s pertinents cr√©√©s dans l‚Äôonglet ¬´&nbsp;Mots cl√©s&nbsp;¬ª.
                </p>
                <div id="contact-keywords-container" class="checkbox-grid" aria-live="polite"></div>
                <p id="contact-keywords-empty" class="empty-state" hidden>
                  Aucun mot cl√© disponible pour le moment. Ajoutez vos mots cl√©s dans l‚Äôonglet ¬´&nbsp;Mots cl√©s&nbsp;¬ª.
                </p>
              </fieldset>
              <div class="form-row">
                <label for="contact-notes">Notes</label>
                <textarea
                  id="contact-notes"
                  name="contact-notes"
                  rows="3"
                  maxlength="500"
                  placeholder="Informations compl√©mentaires (optionnel)."
                ></textarea>
              </div>
              <div class="form-actions">
                <button type="submit" class="primary-button" id="contact-submit-button">Ajouter le contact</button>
                <button type="button" class="secondary-button" id="contact-back-to-search" hidden>
                  Retour √† la recherche
                </button>
                <button type="button" class="secondary-button" id="contact-cancel-edit" hidden>
                  Annuler la modification
                </button>
              </div>
            </form>
          </section>

          <section id="contacts-import" class="page" aria-labelledby="contacts-import-title">
            <header class="page-header">
              <div>
                <h1 id="contacts-import-title">Importer des contacts</h1>
                <p class="page-subtitle">
                  T√©l√©chargez un fichier Excel puis associez ses colonnes √† vos cat√©gories personnalis√©es.
                </p>
              </div>
              <div class="insight-card">
                <span class="insight-label">Contacts d√©tect√©s</span>
                <span class="insight-value" id="contact-import-summary-count">‚Äî</span>
              </div>
            </header>
            <form id="contact-import-form" class="import-form" autocomplete="off">
              <div class="form-row">
                <label for="contact-import-file">Fichier Excel √† importer</label>
                <input id="contact-import-file" type="file" accept=".xlsx,.xls,.csv" />
                <p class="form-hint">
                  Le traitement s‚Äôeffectue enti√®rement dans votre navigateur&nbsp;: aucun fichier n‚Äôest envoy√© sur un serveur externe.
                </p>
              </div>
              <div id="contact-import-file-summary" class="import-file-summary" hidden></div>
              <div id="contact-import-options" class="import-options" hidden>
                <label class="import-header-toggle" for="contact-import-has-header">
                  <input type="checkbox" id="contact-import-has-header" checked />
                  Ignorer la premi√®re ligne (en-t√™tes)
                </label>
                <label class="import-header-toggle" for="contact-import-auto-merge">
                  <input type="checkbox" id="contact-import-auto-merge" />
                  Activer la fusion automatique des doublons d√©tect√©s
                </label>
                <p class="form-hint import-auto-merge-hint">
                  En cas de doublon, la derni√®re version des donn√©es import√©es sera appliqu√©e aux contacts existants lorsque cette option est activ√©e.
                </p>
                <p class="form-hint">
                  S√©lectionnez pour chaque cat√©gorie la colonne du fichier correspondante.
                </p>
                <div id="contact-import-mapping" class="import-mapping" aria-live="polite"></div>
                <p id="contact-import-mapping-empty" class="empty-state" hidden>
                  Chargez un fichier Excel et assurez-vous d‚Äôavoir d√©fini des cat√©gories pour configurer l‚Äôimport.
                </p>
              </div>
              <div id="contact-import-feedback" class="import-feedback" role="status" aria-live="polite"></div>
              <div class="form-actions import-actions">
                <button type="button" class="primary-button" id="contact-import-submit" disabled>
                  Importer les contacts
                </button>
                <button type="button" class="secondary-button" id="contact-import-reset" disabled>
                  R√©initialiser
                </button>
              </div>
            </form>
            <section id="contact-import-preview" class="import-preview" hidden aria-live="polite">
              <h2 class="import-preview-title">Aper√ßu des premi√®res lignes</h2>
              <div class="import-preview-table-wrapper">
                <table class="import-preview-table">
                  <thead></thead>
                  <tbody></tbody>
                </table>
              </div>
            </section>
          </section>

          <section id="contacts-search" class="page" aria-labelledby="contacts-search-title">
            <header class="page-header">
              <div>
                <h1 id="contacts-search-title">Recherche de contact</h1>
                <p class="page-subtitle">
                  Parcourez les contacts enregistr√©s et filtrez-les gr√¢ce aux cat√©gories, mots cl√©s et crit√®res avanc√©s.
                </p>
              </div>
              <div class="insight-card">
                <span class="insight-label">R√©sultats affich√©s</span>
                <span class="insight-value" id="contact-search-count">0</span>
              </div>
            </header>
            <div class="contact-search-panel">
              <div class="contact-search-controls">
                <label class="sr-only" for="contact-search-input">Rechercher un contact</label>
                <input
                  id="contact-search-input"
                  type="search"
                  placeholder="Rechercher par valeur de cat√©gorie, note ou mot cl√©"
                  autocomplete="off"
                />
                <button type="button" class="secondary-button" id="contact-save-search">
                  Enregistrer la recherche
                </button>
                <div class="contact-saved-searches">
                  <label for="contact-saved-searches">Recherches sauvegard√©es</label>
                  <select id="contact-saved-searches">
                    <option value="">Aucune recherche s√©lectionn√©e</option>
                  </select>
                </div>
              </div>
              <p id="contact-save-search-feedback" class="form-feedback" aria-live="polite"></p>
              <form id="contact-advanced-search" class="contact-advanced-search" autocomplete="off">
                <div class="advanced-grid" id="search-category-fields" aria-live="polite"></div>
                <p id="search-categories-empty" class="empty-state" hidden>
                  Ajoutez vos premi√®res cat√©gories pour filtrer vos contacts.
                </p>
                <div class="form-row advanced-multiselect">
                  <label for="search-keywords">S√©lectionnez mes mots cl√©s</label>
                  <select id="search-keywords" name="search-keywords" multiple></select>
                </div>
                <div class="advanced-actions">
                  <button type="submit" class="primary-button">Appliquer les filtres</button>
                  <button type="reset" class="secondary-button">R√©initialiser</button>
                </div>
              </form>
            </div>
            <div class="contact-bulk-actions">
              <p id="contact-selected-count" class="contact-bulk-counter" aria-live="polite">
                Aucun contact s√©lectionn√©
              </p>
              <div class="contact-bulk-controls">
                <button type="button" class="secondary-button" id="contact-select-all" disabled>
                  S√©lectionner tous les r√©sultats
                </button>
                <button
                  type="button"
                  class="secondary-button contact-bulk-delete"
                  id="contact-delete-selected"
                  disabled
                >
                  Supprimer la s√©lection
                </button>
                <div class="contact-bulk-keyword">
                  <label for="contact-bulk-keyword" class="sr-only">Mot cl√© √† ajouter</label>
                  <select id="contact-bulk-keyword" disabled>
                    <option value="">Choisir un mot cl√©</option>
                  </select>
                  <button type="button" class="secondary-button" id="contact-add-keyword" disabled>
                    Ajouter le mot cl√©
                  </button>
                </div>
              </div>
            </div>
            <ul id="contact-list" class="contact-list" aria-live="polite"></ul>
            <p id="contact-empty-state" class="empty-state" hidden>
              Ajoutez vos premiers contacts pour les retrouver ici.
            </p>
            <nav id="contact-pagination" class="contact-pagination" aria-label="Pagination des contacts" hidden>
              <div class="contact-pagination-info">
                <span id="contact-pagination-summary">Affichage 0 sur 0 contacts</span>
                <span id="contact-pagination-page">Page 1 / 1</span>
              </div>
              <div class="contact-pagination-controls">
                <button
                  id="contact-pagination-prev"
                  type="button"
                  class="contact-pagination-button"
                  aria-label="Page pr√©c√©dente"
                >
                  Pr√©c√©dent
                </button>
                <button
                  id="contact-pagination-next"
                  type="button"
                  class="contact-pagination-button"
                  aria-label="Page suivante"
                >
                  Suivant
                </button>
              </div>
              <label class="contact-pagination-size" for="contact-results-per-page">
                <span>R√©sultats par page</span>
                <select id="contact-results-per-page" name="contact-results-per-page">
                  <option value="10" selected>10</option>
                  <option value="25">25</option>
                  <option value="50">50</option>
                </select>
              </label>
            </nav>
          </section>

          <section id="saved-searches" class="page" aria-labelledby="saved-searches-title">
            <header class="page-header">
              <div>
                <h1 id="saved-searches-title">Recherches sauvegard√©es</h1>
                <p class="page-subtitle">
                  Conservez vos filtres favoris pour les r√©utiliser en un clic ou les partager avec votre √©quipe.
                </p>
              </div>
              <div class="insight-card">
                <span class="insight-label">Recherches actives</span>
                <span class="insight-value" id="saved-search-count">0</span>
              </div>
            </header>
            <div class="saved-searches-content">
              <div class="saved-searches-description">
                <p>
                  Enregistrez une recherche depuis la page de consultation des contacts puis retrouvez-la ici pour
                  l'appliquer rapidement ou l'utiliser dans vos campagnes de communication.
                </p>
                <p>
                  Pour mettre √† jour une recherche, appliquez-la, ajustez les filtres puis enregistrez-la √† nouveau avec
                  le m√™me nom.
                </p>
              </div>
              <ul id="saved-search-list" class="saved-search-list" aria-live="polite"></ul>
              <p id="saved-search-empty" class="empty-state" hidden>
                Aucune recherche sauvegard√©e pour le moment. Cr√©ez-en depuis la recherche de contacts.
              </p>
            </div>
          </section>

          <section id="email-templates" class="page" aria-labelledby="email-templates-title">
            <header class="page-header">
              <div>
                <h1 id="email-templates-title">Cr√©er un mod√®le mail</h1>
                <p class="page-subtitle">
                  Composez vos messages types, ajoutez des images cliquables et pr√©parez vos campagnes √† l'avance.
                </p>
              </div>
            </header>
            <div class="email-template-layout">
              <form id="email-template-form" class="email-template-form" autocomplete="off">
                <div class="form-row">
                  <label for="email-template-name">Nom du mod√®le *</label>
                  <input id="email-template-name" name="email-template-name" type="text" required maxlength="120" />
                </div>
                <div class="form-row">
                  <label for="email-template-subject">Objet du mail *</label>
                  <input
                    id="email-template-subject"
                    name="email-template-subject"
                    type="text"
                    maxlength="140"
                    required
                  />
                </div>
                <div class="email-template-block-actions">
                  <span>Ajouter un bloc&nbsp;:</span>
                  <button type="button" class="secondary-button" id="email-template-add-paragraph">
                    Paragraphe
                  </button>
                  <button type="button" class="secondary-button" id="email-template-add-image">Image</button>
                  <button type="button" class="secondary-button" id="email-template-add-button">
                    Bouton d'appel √† l'action
                  </button>
                </div>
                <p class="form-hint">
                  Les images peuvent √™tre li√©es √† une adresse web. Les destinataires ouvriront le lien associ√© lors d'un
                  clic sur l'image.
                </p>
                <div id="email-template-blocks" class="email-template-blocks" aria-live="polite">
                  <p class="empty-state">Ajoutez un bloc pour commencer la composition du message.</p>
                </div>
                <p id="email-template-feedback" class="form-feedback" aria-live="polite"></p>
                <div class="form-actions">
                  <button type="submit" class="primary-button">Enregistrer le mod√®le</button>
                  <button type="reset" class="secondary-button">R√©initialiser</button>
                </div>
              </form>
              <aside class="email-template-preview" aria-label="Pr√©visualisation du mod√®le">
                <h2>Pr√©visualisation</h2>
                <div id="email-template-preview" class="email-preview" aria-live="polite">
                  <p class="empty-state">Ajoutez des blocs pour visualiser le rendu du mail.</p>
                </div>
              </aside>
            </div>
            <section class="email-template-list-wrapper" aria-labelledby="email-template-list-title">
              <h2 id="email-template-list-title">Mod√®les enregistr√©s</h2>
              <ul id="email-template-list" class="email-template-list" aria-live="polite"></ul>
              <p id="email-template-empty" class="empty-state" hidden>Aucun mod√®le n'a encore √©t√© enregistr√©.</p>
            </section>
          </section>

          <section id="email-campaigns" class="page" aria-labelledby="email-campaigns-title">
            <header class="page-header">
              <div>
                <h1 id="email-campaigns-title">Envoyer une campagne de mail</h1>
                <p class="page-subtitle">
                  S√©lectionnez un mod√®le et une recherche sauvegard√©e pour informer rapidement tous les contacts cibl√©s.
                </p>
              </div>
            </header>
            <div class="email-campaign-layout">
              <form id="email-campaign-form" class="email-campaign-form" autocomplete="off">
                <div class="form-row">
                  <label for="email-campaign-name">Nom de la campagne *</label>
                  <input id="email-campaign-name" name="email-campaign-name" type="text" required maxlength="120" />
                </div>
                <div class="form-row">
                  <label for="email-campaign-sender-name">Nom de l'exp√©diteur</label>
                  <input
                    id="email-campaign-sender-name"
                    name="email-campaign-sender-name"
                    type="text"
                    maxlength="120"
                  />
                </div>
                <div class="form-row">
                  <label for="email-campaign-sender-email">Adresse mail de l'exp√©diteur *</label>
                  <input
                    id="email-campaign-sender-email"
                    name="email-campaign-sender-email"
                    type="email"
                    autocomplete="email"
                    required
                  />
                </div>
                <div class="form-row">
                  <label for="campaign-template-select">Mod√®le √† utiliser *</label>
                  <select id="campaign-template-select" name="campaign-template-select" required></select>
                </div>
                <div class="form-row">
                  <label for="campaign-saved-search-select">Recherche sauvegard√©e *</label>
                  <select id="campaign-saved-search-select" name="campaign-saved-search-select" required></select>
                </div>
                <div class="form-row">
                  <label for="email-campaign-subject">Objet de la campagne *</label>
                  <input
                    id="email-campaign-subject"
                    name="email-campaign-subject"
                    type="text"
                    maxlength="140"
                    required
                  />
                </div>
                <p class="form-hint">
                  Seuls les contacts disposant d'une adresse mail valide dans la recherche s√©lectionn√©e recevront le
                  message.
                </p>
                <p id="email-campaign-feedback" class="form-feedback" aria-live="polite"></p>
                <div class="form-actions">
                  <button type="submit" class="primary-button">Lancer la campagne</button>
                  <button type="reset" class="secondary-button">R√©initialiser</button>
                </div>
              </form>
              <aside class="email-campaign-preview" aria-label="Pr√©visualisation de la campagne">
                <h2>Destinataires cibl√©s</h2>
                <p id="campaign-summary" class="campaign-summary">
                  S√©lectionnez une recherche sauvegard√©e pour afficher les contacts concern√©s.
                </p>
                <ul id="campaign-recipient-list" class="campaign-recipient-list" aria-live="polite"></ul>
                <h2>Pr√©visualisation du mail</h2>
                <div id="campaign-email-preview" class="email-preview" aria-live="polite">
                  <p class="empty-state">Choisissez un mod√®le pour afficher un aper√ßu.</p>
                </div>
              </aside>
            </div>
            <section class="campaign-history" aria-labelledby="campaign-history-title">
              <h2 id="campaign-history-title">Campagnes envoy√©es</h2>
              <ul id="campaign-history-list" class="campaign-history-list" aria-live="polite"></ul>
              <p id="campaign-history-empty" class="empty-state" hidden>
                Aucune campagne n'a encore √©t√© envoy√©e.
              </p>
            </section>
          </section>

          <section id="team" class="page" aria-labelledby="team-title">
            <header class="page-header">
              <div>
                <h1 id="team-title">√âquipe</h1>
                <p class="page-subtitle">
                  G√©rez qui peut acc√©der au panel et se voir attribuer des t√¢ches.
                </p>
              </div>
            </header>
            <section class="summary" aria-labelledby="team-owner-title">
              <h2 id="team-owner-title">Fondateur du panel</h2>
              <div class="summary-grid">
                <div class="summary-item">
                  <span class="summary-label">Propri√©taire</span>
                  <span class="summary-value" id="team-owner-name">‚Äî</span>
                </div>
                <div class="summary-item">
                  <span class="summary-label">Membres actuels</span>
                  <span class="summary-value" id="team-count">0</span>
                </div>
              </div>
              <p class="summary-note">
                Seul le fondateur peut acc√©der √† cette page et modifier la composition de l‚Äô√©quipe.
              </p>
            </section>
            <section class="category-form" aria-labelledby="team-add-title">
              <h2 id="team-add-title">Ajouter un membre</h2>
              <form id="team-add-form" class="form-grid" autocomplete="off">
                <div class="form-row">
                  <label for="team-user-select">Utilisateur</label>
                  <select id="team-user-select" name="username" required></select>
                </div>
                <div class="form-actions">
                  <button type="submit" class="primary-button">Ajouter √† l'√©quipe</button>
                </div>
              </form>
              <p class="form-hint">
                La liste propose uniquement les utilisateurs existants qui ne sont pas d√©j√† membres.
              </p>
            </section>
            <section class="category-list-wrapper" aria-labelledby="team-list-title">
              <h2 id="team-list-title">Membres de l'√©quipe</h2>
              <ul id="team-list" class="category-list" aria-live="polite"></ul>
              <p id="team-empty" class="empty-state" hidden>Aucun membre pour l‚Äôinstant.</p>
            </section>
          </section>
        </main>
        <aside class="context-panel" aria-label="Options du module">
          <h2 class="sr-only" id="context-nav-title">Options du module</h2>
          <nav id="context-nav" class="context-nav" aria-labelledby="context-nav-title">
            <ul id="context-nav-list" class="context-nav-list"></ul>
          </nav>
          <p id="context-empty-state" class="context-empty-state" hidden>
            S√©lectionnez un module pour afficher les options disponibles.
          </p>
          <p class="context-tagline">
            G√©rez vos donn√©es professionnelles, associations et structures en toute simplicit√©.
          </p>
        </aside>
      </div>
    </div>

    <div
      id="calendar-overlay"
      class="calendar-overlay"
      role="dialog"
      aria-modal="true"
      aria-labelledby="calendar-dialog-title"
      aria-hidden="true"
      hidden
    >
      <div class="calendar-dialog">
        <header class="calendar-header">
          <div>
            <h2 id="calendar-dialog-title">Calendrier des √©v√®nements</h2>
            <p class="calendar-subtitle">
              Planifiez vos actions et notez vos rendez-vous importants.
            </p>
          </div>
          <button
            id="calendar-close-button"
            class="calendar-close-button"
            type="button"
            aria-label="Fermer le calendrier"
          >
            ‚úï
          </button>
        </header>
        <div class="calendar-toolbar">
          <div class="calendar-view-toggle" role="group" aria-label="Changer la vue du calendrier">
            <button
              type="button"
              class="calendar-view-button"
              data-calendar-view="week"
              aria-pressed="false"
            >
              Semaine
            </button>
            <button
              type="button"
              class="calendar-view-button active"
              data-calendar-view="month"
              aria-pressed="true"
            >
              Mois
            </button>
          </div>
          <div class="calendar-navigation">
            <button
              type="button"
              class="calendar-nav-button"
              data-calendar-nav="prev"
              aria-label="P√©riode pr√©c√©dente"
            >
              ‚óÄ
            </button>
            <span id="calendar-current-period" class="calendar-current-period">‚Äî</span>
            <button
              type="button"
              class="calendar-nav-button"
              data-calendar-nav="next"
              aria-label="P√©riode suivante"
            >
              ‚ñ∂
            </button>
          </div>
        </div>
        <div class="calendar-layout">
          <div class="calendar-main">
            <div id="calendar-grid" class="calendar-grid" role="grid" aria-live="polite"></div>
          </div>
          <aside class="calendar-side">
            <div class="calendar-selected-date">
              <h3 id="calendar-selected-date-label">‚Äî</h3>
              <p id="calendar-selected-date-summary" class="calendar-selected-date-summary">
                Choisissez un jour pour afficher les d√©tails.
              </p>
            </div>
            <form id="calendar-event-form" class="calendar-event-form">
              <h3 class="calendar-form-title">Nouvel √©v√®nement</h3>
              <div class="form-row">
                <label for="calendar-event-title">Titre *</label>
                <input id="calendar-event-title" name="title" type="text" required maxlength="120" />
              </div>
              <div class="calendar-form-row">
                <div class="form-row">
                  <label for="calendar-event-date">Date *</label>
                  <input id="calendar-event-date" name="date" type="date" required />
                </div>
                <div class="form-row">
                  <label for="calendar-event-time">Heure</label>
                  <input id="calendar-event-time" name="time" type="time" />
                </div>
              </div>
              <div class="form-row">
                <label for="calendar-event-notes">Notes</label>
                <textarea
                  id="calendar-event-notes"
                  name="notes"
                  rows="3"
                  placeholder="Ajoutez des d√©tails ou des objectifs."
                ></textarea>
              </div>
              <div class="calendar-form-actions">
                <button type="reset" class="secondary-button">R√©initialiser</button>
                <button type="submit" class="primary-button">Ajouter</button>
              </div>
            </form>
            <div class="calendar-events-wrapper">
              <h3 class="calendar-events-title">√âv√®nements du jour</h3>
              <p id="calendar-event-empty" class="calendar-empty-state">
                Aucun √©v√®nement enregistr√© pour cette date.
              </p>
              <ul id="calendar-event-list" class="calendar-event-list"></ul>
            </div>
          </aside>
        </div>
      </div>
    </div>

    <template id="contact-item-template">
      <li class="contact-item">
        <div class="contact-header">
          <div class="contact-header-text">
            <div class="contact-header-main">
              <h3 class="contact-name"></h3>
              <span class="contact-type-badge"></span>
            </div>
            <span class="contact-created"></span>
          </div>
          <label class="contact-select">
            <input type="checkbox" class="contact-select-checkbox" />
            <span class="sr-only">S√©lectionner ce contact</span>
          </label>
        </div>
        <div class="contact-details">
          <p class="contact-coordinates"></p>
          <p class="contact-notes"></p>
        </div>
        <div class="contact-categories"></div>
        <div class="contact-keywords"></div>
        <div class="contact-actions">
          <button type="button" class="contact-action-button" data-action="edit-contact">
            Modifier
          </button>
          <button
            type="button"
            class="contact-action-button contact-action-button--danger"
            data-action="delete-contact"
          >
            Supprimer
          </button>
        </div>
      </li>
    </template>
    <template id="category-item-template">
      <li class="category-item">
        <button
          type="button"
          class="category-drag-handle"
          data-drag-handle
          aria-label="R√©organiser la cat√©gorie"
          title="D√©placer la cat√©gorie"
          draggable="true"
        >
          ‚ãÆ‚ãÆ
        </button>
        <div class="category-main">
          <h3 class="category-title"></h3>
          <p class="category-description"></p>
          <p class="category-meta"></p>
        </div>
        <div class="category-actions">
          <button type="button" class="category-button" data-action="edit">Modifier</button>
          <button type="button" class="category-button category-button--danger" data-action="delete">
            Supprimer
          </button>
        </div>
      </li>
    </template>
    <template id="keyword-item-template">
      <li class="keyword-item">
        <div class="keyword-main">
          <h3 class="keyword-title"></h3>
          <p class="keyword-description"></p>
        </div>
        <div class="keyword-actions">
          <button type="button" class="keyword-button" data-action="edit">Modifier</button>
          <button type="button" class="keyword-button keyword-button--danger" data-action="delete">
            Supprimer
          </button>
        </div>
      </li>
    </template>
    <script src="assets/app.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
    <script src="assets/importContacts.js"></script>
  </body>
</html>
